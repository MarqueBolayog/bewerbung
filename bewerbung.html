<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bewerbungsgenerator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
    <style>
        body {
            font-family: 'Calibri', sans-serif;
            margin: 0;
            background-color: #f4f4f4;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }
        .container {
            max-width: 600px;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            text-align: center;
        }
        label {
            font-weight: bold;
            display: block;
            text-align: left;
        }
        input {
            width: 100%;
            padding: 8px;
            margin: 5px 0 15px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        button {
            width: 100%;
            padding: 10px;
            background: #007BFF;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
        }
        button:hover {
            background: #0056b3;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Bewerbungsgenerator</h1>
        <form id="coverLetterForm">
            <label for="company_name">Firmenname:</label>
            <input type="text" id="company_name" name="company_name" required>
            <label for="contact_person">Ansprechpartner:</label>
            <input type="text" id="contact_person" name="contact_person">
            <label for="company_address">Adresse der Firma:</label>
            <input type="text" id="company_address" name="company_address" required>
            <label for="position">Stellenbezeichnung:</label>
            <input type="text" id="position" name="position" required>
            <button type="submit">Anschreiben generieren</button>
        </form>
        <h2>Anschreiben:</h2>
        <pre id="coverLetterOutput"></pre>
        <button type="button" id="downloadPdf">Als PDF herunterladen</button>
    </div>

    <script>
        document.getElementById("coverLetterForm").addEventListener("submit", (event) => {
            event.preventDefault();
            const companyName = document.getElementById("company_name").value;
            const contactPerson = document.getElementById("contact_person").value;
            const companyAddress = document.getElementById("company_address").value;
            const position = document.getElementById("position").value;
            document.getElementById("coverLetterOutput").textContent = `
Marque Bolay-Og
Merlinweg 3, 61231 Bad Nauheim ● 0157 31489393
marque_b@hotmail.de

${companyName}
${contactPerson}
${companyAddress}

Bewerbung als ${position}
Sehr geehrte/r ${contactPerson || "Damen und Herren"},

bei der Suche nach einer Möglichkeit, mein sehr breites Fachwissen in der Industrie engagiert einzubringen, ist mir Ihr Stellenangebot in der Jobsuche sofort aufgefallen. Mit über 15 Jahren Berufserfahrung in der Produktion und mit meiner erfolgreich abgeschlossenen Umschulung zum Industriekaufmann, können Sie mich bereits nach einer sehr kurzen Onboardingphase uneingeschränkt einsetzen. In einem Unternehmen zu arbeiten, das mit höchster Sorgfalt und professioneller Kompetenz erfolgreich ist, motiviert mich zusätzlich.

In der Vergangenheit war ich für das Entwickeln von Marketingstrategien und -kampagnen, das Customer-Relationship-Management sowie für das Durchführen des Beschaffungs- und Einkaufsmanagements und darüber hinaus für das Verwalten des Lagers und das Koordinieren der Logistik mitverantwortlich, sodass ich die sachgerechte Umsetzung der entsprechenden Arbeitsprozesse sicher beherrsche. Aufgrund meiner kontinuierlichen Tätigkeit in der Produktion bin ich bestens vertraut mit sämtlichen Anforderungen und Vorschriften und gewährleiste deren präzise Einhaltung.

Neben meiner fachlichen Kompetenz werde ich besonders für meine Belastbarkeit sowie für meine schnelle und zuverlässige Arbeitsweise geschätzt. Hinzu kommt, dass ich jederzeit voll motiviert bin und mit großem Einsatz auch über die reguläre Arbeitszeit hinaus flexibel zur Verfügung stehe, wenn Fristen eingehalten werden müssen oder ein Kollege ausgefallen ist. Meine freundliche und offene Art hilft mir, mich schnell in bestehende Teams zu integrieren.

Mein Eintrittsdatum stimme ich gern individuell auf Ihren Bedarf ab und stehe Ihnen für ein Probearbeiten jederzeit zur Verfügung, um meine Fähigkeiten unter Beweis zu stellen.

Auf die Gelegenheit, in einem persönlichen Gespräch mehr über Ihre Erwartungen an mich zu erfahren und Sie von meiner fachlichen Qualifikation und Motivation zu überzeugen, freue ich mich bereits jetzt.

Mit freundlichen Grüßen

Marque Bolay-Og

Anlagen:
- Lebenslauf
- Zeugnisse

`;
        });

        document.getElementById("downloadPdf").addEventListener("click", async () => {
            const { jsPDF } = window.jspdf;
            const { PDFDocument } = PDFLib;
            const doc = new jsPDF();
            const headerImage = "data:image/png;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+Cjxzdmcgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgdmlld0JveD0iMCAwIDI0ODEgNDMyIiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHhtbDpzcGFjZT0icHJlc2VydmUiIHhtbG5zOnNlcmlmPSJodHRwOi8vd3d3LnNlcmlmLmNvbS8iIHN0eWxlPSJmaWxsLXJ1bGU6ZXZlbm9kZDtjbGlwLXJ1bGU6ZXZlbm9kZDtzdHJva2UtbGluZWNhcDpyb3VuZDtzdHJva2UtbGluZWpvaW46cm91bmQ7c3Ryb2tlLW1pdGVybGltaXQ6MS41OyI+CiAgICA8ZyBpZD0iQXJ0Qm9hcmQxIiB0cmFuc2Zvcm09Im1hdHJpeCgxLDAsMCwwLjEyMzA0MywwLDApIj4KICAgICAgICA8cmVjdCB4PSIwIiB5PSIwIiB3aWR0aD0iMjQ4MC4zMiIgaGVpZ2h0PSIzNTA3Ljg3IiBzdHlsZT0iZmlsbDpub25lOyIvPgogICAgICAgIDxnIHRyYW5zZm9ybT0ibWF0cml4KDEsMCwwLDguMTI3MjUsMCwwKSI+CiAgICAgICAgICAgIDxnIHRyYW5zZm9ybT0ibWF0cml4KDEsMCwwLDEsMCw5KSI+CiAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMjk2LjU2LDIwNy43NEwyMjA1LjYxLDIwNy43NCIgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6cmdiKDAsMTAyLDI1NSk7c3Ryb2tlLXdpZHRoOjEyLjVweDsiLz4KICAgICAgICAgICAgPC9nPgogICAgICAgICAgICA8ZyB0cmFuc2Zvcm09Im1hdHJpeCgxLDAsMCwxLC05LjM5NTkxLDIuOTU3OTQpIj4KICAgICAgICAgICAgICAgIDx0ZXh0IHg9IjEwMjUuOTFweCIgeT0iMTkzLjY0M3B4IiBzdHlsZT0iZm9udC1mYW1pbHk6J0NhbGlicmktQm9sZCcsICdDYWxpYnJpJywgc2Fucy1zZXJpZjtmb250LXdlaWdodDo3MDA7Zm9udC1zaXplOjYyLjVweDsiPk1hcjx0c3BhbiB4PSIxMTMyLjg1cHggMTE2Ni4zOHB4ICIgeT0iMTkzLjY0M3B4IDE5My42NDNweCAiPnF1PC90c3Bhbj5lIEJvbGE8dHNwYW4geD0iMTM1OS4yMnB4IDEzODcuNzZweCAxNDA2Ljg5cHggIiB5PSIxOTMuNjQzcHggMTkzLjY0M3B4IDE5My42NDNweCAiPnktbzwvdHNwYW4+ZzwvdGV4dD4KICAgICAgICAgICAgPC9nPgogICAgICAgICAgICA8Zz4KICAgICAgICAgICAgICAgIDx0ZXh0IHg9Ijc1MC4xN3B4IiB5PSIyNjMuMzUzcHgiIHN0eWxlPSJmb250LWZhbWlseTonQ2FsaWJyaS1Cb2xkJywgJ0NhbGlicmknLCBzYW5zLXNlcmlmO2ZvbnQtd2VpZ2h0OjcwMDtmb250LXNpemU6NTBweDsiPk1lcmxpbjx0c3BhbiB4PSI4ODcuODE2cHggOTI0LjY4MnB4IDk0OS44NTJweCAiIHk9IjI2My4zNTNweCAyNjMuMzUzcHggMjYzLjM1M3B4ICI+d2VnPC90c3Bhbj4gMyDCoCDCoDYxMjMxIEJhZCBOYXVoZWltIMKgIDAxNTczMTQ4OTM5MzwvdGV4dD4KICAgICAgICAgICAgICAgIDx0ZXh0IHg9IjEwMTAuMTFweCIgeT0iMzEzLjM1M3B4IiBzdHlsZT0iZm9udC1mYW1pbHk6J0NhbGlicmktQm9sZCcsICdDYWxpYnJpJywgc2Fucy1zZXJpZjtmb250LXdlaWdodDo3MDA7Zm9udC1zaXplOjUwcHg7Ij5tYXI8dHNwYW4geD0iMTA5Mi42MnB4IDExMTkuNDVweCAiIHk9IjMxMy4zNTNweCAzMTMuMzUzcHggIj5xdTwvdHNwYW4+ZV9iQGhvdG1haWwuZGU8L3RleHQ+CiAgICAgICAgICAgIDwvZz4KICAgICAgICAgICAgPGcgdHJhbnNmb3JtPSJtYXRyaXgoMS43MzU5NCwwLDAsMS42NDU5MiwtNzUxLjI2NCwtMTU3Ljg5NikiPgogICAgICAgICAgICAgICAgPGVsbGlwc2UgY3g9IjEwMjUuMDYiIGN5PSIyNDcuNDI4IiByeD0iNC4yNDQiIHJ5PSI0Ljc2MyIvPgogICAgICAgICAgICA8L2c+CiAgICAgICAgPC9nPgogICAgICAgIDxnIHRyYW5zZm9ybT0ibWF0cml4KDEuNzM1OTQsMCwwLDEzLjM3NjgsLTI4Ny43NzcsLTEyODMuMjYpIj4KICAgICAgICAgICAgPGVsbGlwc2UgY3g9IjEwMjUuMDYiIGN5PSIyNDcuNDI4IiByeD0iNC4yNDQiIHJ5PSI0Ljc2MyIvPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+Cg==";
            doc.addImage(headerImage, "PNG", 10, 10, 180, 20);
            doc.setFont("helvetica");
            doc.setFontSize(12);
            const text = document.getElementById("coverLetterOutput").textContent;
            doc.text(text, 10, 40, { maxWidth: 180, align: "justify" });
            const pdfBytes = doc.output("arraybuffer");

            try {
                const [lebenslaufResponse, zeugnisseResponse] = await Promise.all([
                    fetch("https://github.com/MarqueBolayog/bewerbung/raw/main/lebenslauf.pdf").then(res => res.arrayBuffer()),
                    fetch("https://github.com/MarqueBolayog/bewerbung/raw/main/zeugnisse.pdf").then(res => res.arrayBuffer())
                ]);
                const pdfDoc = await PDFDocument.create();
                const bewerbungPdf = await PDFDocument.load(pdfBytes);
                const bewerbungPages = await pdfDoc.copyPages(bewerbungPdf, bewerbungPdf.getPageIndices());
                bewerbungPages.forEach(page => pdfDoc.addPage(page));
                const lebenslaufPdf = await PDFDocument.load(lebenslaufResponse);
                const zeugnissePdf = await PDFDocument.load(zeugnisseResponse);
                const lebenslaufPages = await pdfDoc.copyPages(lebenslaufPdf, lebenslaufPdf.getPageIndices());
                const zeugnissePages = await pdfDoc.copyPages(zeugnissePdf, zeugnissePdf.getPageIndices());
                lebenslaufPages.forEach(page => pdfDoc.addPage(page));
                zeugnissePages.forEach(page => pdfDoc.addPage(page));
                const finalPdfBytes = await pdfDoc.save();
                const blob = new Blob([finalPdfBytes], { type: "application/pdf" });
                const link = document.createElement("a");
                link.href = URL.createObjectURL(blob);
                link.download = "Bewerbung.pdf";
                link.click();
            } catch (error) {
                console.error("Fehler beim Erstellen des PDFs:", error);
                alert("Fehler beim Erstellen der Bewerbung. Überprüfe die Links.");
            }
        });
    </script>
</body>
</html>
